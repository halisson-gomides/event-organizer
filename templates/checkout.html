{% extends "base.html" %}
{% block title %}Checkout{% endblock %}
{% block content %}
<h2>Checkout — {{ occurrence.start_at|to_local_time }} a {{ occurrence.end_at|to_local_time }}</h2>

<div class="checkout-form">
  {% if checkout_ok %}
    <div class="ok">Checkout realizado com sucesso.</div>
  {% endif %}

  {% if error %}
    <div class="error">{{ error }}</div>
  {% endif %}

  <form hx-post="/occurrences/{{ occurrence.id }}/checkout" hx-target="this" hx-swap="outerHTML">
    <div class="form-group">
      <label>Participante:
        <select name="participant_id" required>
          {% for p in participants %}
            <option value="{{ p.id }}">{{ p.full_name }} ({{ p.birth_date.strftime('%d/%m/%Y') }})</option>
          {% endfor %}
        </select>
      </label>
    </div>
    <div class="form-group">
      <label>Quem está realizando o checkout:
        <select name="checkout_by_participant_id" required>
          {% for p in participants %}
            <option value="{{ p.id }}">{{ p.full_name }} ({{ p.birth_date|date:'d/m/Y' }})</option>
          {% endfor %}
        </select>
      </label>
    </div>
    <div class="form-group">
      <label>Código (exigido para crianças): <input type="text" name="code"></label>
    </div>
    <div class="form-actions">
      <button type="submit" class="btn-primary">Checkout</button>
    </div>
  </form>
</div>
{% endblock %}